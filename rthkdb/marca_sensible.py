import rethinkdb as r
from rethinkdb.errors import RqlRuntimeError
from datetime import timedelta, datetime, timezone
import pytz
import os

rt_host = '10.54.217.83'
rt_port = os.environ['rt_port']
rt_db = "csn"

conn = r.connect(host=rt_host, port=rt_port, db=rt_db)

sfile = ['01-0850-50L.S201903',
'01-1059-41L.S201906',
'01-1844-50L.S201904',
'01-2243-27L.S201903',
'02-0048-10L.S201907',
'02-0146-26L.S201904',
'02-0155-29L.S201903',
'02-0321-15L.S201906',
'02-1234-12L.S201905',
'02-1317-39L.S201904',
'02-1949-27L.S201906',
'02-2021-54L.S201903',
'02-2329-33L.S201905',
'03-0149-00L.S201904',
'03-0256-42L.S201902',
'03-0422-23L.S201906',
'03-0842-12L.S201906',
'03-1434-00L.S201904',
'03-1812-39L.S201904',
'04-0418-16L.S201903',
'04-0725-45L.S201902',
'04-1033-30L.S201906',
'04-1200-09L.S201904',
'04-1248-06L.S201906',
'04-1347-33L.S201901',
'04-1719-18L.S201906',
'04-1951-05L.S201905',
'05-1619-41L.S201906',
'05-1631-29L.S201903',
'05-1832-41L.S201904',
'05-2000-06L.S201902',
'05-2312-54L.S201901',
'06-0515-03L.S201903',
'06-1756-50L.S201902',
'06-2025-35L.S201901',
'06-2133-03L.S201904',
'06-2202-00L.S201904',
'07-0050-02L.S201905',
'07-0550-38L.S201903',
'07-0634-10L.S201903',
'07-0634-16L.S201903',
'07-0921-38L.S201903',
'07-1343-29L.S201901',
'07-1457-35L.S201904',
'07-1534-27L.S201903',
'07-1842-18L.S201902',
'07-2103-23L.S201902',
'08-0152-28L.S201904',
'08-0639-39L.S201904',
'08-0814-19L.S201905',
'08-0930-01L.S201904',
'08-1344-08L.S201906',
'08-1740-58L.S201901',
'08-2232-55L.S201901',
'09-0216-58L.S201903',
'09-0221-06L.S201904',
'09-0247-33L.S201904',
'09-0253-16L.S201905',
'09-2005-16L.S201901',
'09-2045-43L.S201903',
'09-2200-55L.S201906',
'10-0317-00L.S201906',
'10-0347-45L.S201905',
'10-1143-24L.S201906',
'10-1308-02L.S201903',
'10-2100-36L.S201902',
'11-0018-19L.S201904',
'11-1222-25L.S201901',
'11-1422-16L.S201903',
'11-1707-30L.S201904',
'11-2117-02L.S201901',
'11-2210-34L.S201903',
'12-0210-22L.S201902',
'12-0521-45L.S201901',
'12-0601-15L.S201901',
'12-1202-52L.S201904',
'12-1413-09L.S201902',
'13-0211-00L.S201903',
'13-1152-28L.S201905',
'13-1153-25L.S201903',
'13-1612-20L.S201906',
'13-1612-21L.S201906',
'13-2250-11L.S201906',
'13-2250-12L.S201906',
'14-0019-10L.S201906',
'14-0414-35L.S201906',
'14-0815-00L.S201903',
'14-1116-01L.S201901',
'14-2014-47L.S201901',
'15-0700-07L.S201902',
'15-1427-59L.S201903',
'15-1605-16L.S201904',
'16-0054-13L.S201904',
'16-2345-19L.S201906',
'17-0438-55L.S201906',
'17-0635-32L.S201902',
'17-1416-24L.S201905',
'18-0252-26L.S201905',
'18-0406-31L.S201904',
'18-1234-08L.S201901',
'18-1333-27L.S201902',
'18-1502-55L.S201901',
'18-1751-57L.S201905',
'18-2356-45L.S201903',
'19-0407-02L.S201902',
'19-0509-42L.S201902',
'19-1443-32L.S201904',
'19-2137-41L.S201904',
'19-2222-00L.S201906',
'20-0123-24L.S201906',
'20-0132-48L.S201901',
'20-0258-11L.S201902',
'20-0459-44L.S201901',
'20-0739-27L.S201901',
'20-1118-31L.S201905',
'20-2323-44L.S201904',
'21-0131-10L.S201901',
'21-1000-08L.S201904',
'21-2027-35L.S201901',
'21-2034-34L.S201903',
'22-0036-44L.S201901',
'22-0041-20L.S201901',
'22-0422-42L.S201903',
'22-0423-12L.S201905',
'22-0512-01L.S201902',
'22-0925-58L.S201902',
'22-1117-49L.S201904',
'22-1344-48L.S201901',
'22-1619-26L.S201901',
'22-2242-29L.S201905',
'23-0059-24L.S201905',
'23-0232-46L.S201903',
'23-0247-22L.S201902',
'23-1338-52L.S201903',
'23-1902-44L.S201903',
'24-0442-42L.S201906',
'24-0624-32L.S201904',
'24-0725-45L.S201901',
'24-0806-10L.S201901',
'24-1028-28L.S201901',
'24-1033-18L.S201906',
'24-1857-31L.S201904',
'24-2015-59L.S201905',
'25-0448-51L.S201906',
'25-0806-58L.S201905',
'25-0829-17L.S201901',
'25-1052-39L.S201903',
'25-1259-06L.S201903',
'25-1528-41L.S201902',
'25-1549-35L.S201901',
'25-1807-36L.S201901',
'25-2028-32L.S201904',
'25-2254-32L.S201902',
'26-0622-33L.S201904',
'26-0729-49L.S201906',
'26-0748-56L.S201901',
'26-0847-26L.S201902',
'26-0909-31L.S201902',
'26-1036-17L.S201902',
'27-0034-51L.S201903',
'27-0357-10L.S201903',
'27-0509-00L.S201901',
'27-0820-25L.S201903',
'27-0952-26L.S201901',
'27-1354-15L.S201901',
'27-1949-53L.S201906',
'27-2250-02L.S201904',
'28-0117-25L.S201904',
'28-0333-37L.S201901',
'28-0646-18L.S201901',
'28-0830-40L.S201906',
'28-0900-46L.S201901',
'28-1025-23L.S201904',
'28-1203-01L.S201904',
'28-1505-31L.S201903',
'28-1817-09L.S201902',
'29-0107-20L.S201903',
'29-0457-04L.S201906',
'29-1053-15L.S201903',
'29-1213-45L.S201901',
'29-2014-43L.S201906',
'29-2224-17L.S201904',
'30-0744-50L.S201901',
'30-1833-14L.S201903',
'31-1523-16L.S201905',
'31-1949-51L.S201901']

for s in sfile:
    print(r.table('migra').filter({'sfile':s}).update({'sensible':True}).run(conn))
    # print(f'r.table(migra).filter(sfile:{s}).update(sensible:True).run(conn)')

conn.close()

